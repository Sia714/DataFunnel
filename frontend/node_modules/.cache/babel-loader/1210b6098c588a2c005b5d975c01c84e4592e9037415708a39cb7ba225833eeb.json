{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Desktop\\\\Sayjan Desktop\\\\Projects\\\\DataFunnel\\\\frontend\\\\src\\\\components\\\\FunnelChart.js\",\n  _s = $RefreshSig$();\nimport * as d3 from \"d3\";\nimport { useEffect, useRef } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FunnelChart = ({\n  data\n}) => {\n  _s();\n  const ref = useRef();\n  useEffect(() => {\n    if (!data || !ref.current) return;\n    const cleanedData = data.map(d => ({\n      ...d,\n      acv: Number(d.acv)\n    }));\n    const width = ref.current.clientWidth;\n    if (width === 0) {\n      console.error(\"Chart container width is zero.\");\n      return;\n    }\n    const height = 500;\n    const svg = d3.select(ref.current).html(\"\").append(\"svg\").attr(\"viewBox\", `0 0 ${width} ${height}`).attr(\"preserveAspectRatio\", \"xMidYMid meet\").style(\"width\", \"100%\").style(\"height\", \"100%\");\n    const maxAcv = d3.max(cleanedData, d => d.acv);\n    const funnelWidth = width * 0.9;\n    const sectionHeight = height / cleanedData.length;\n    const color = d3.scaleOrdinal(d3.schemeBlues[cleanedData.length + 1]);\n    cleanedData.forEach((d, i) => {\n      var _cleanedData;\n      const prevAcv = ((_cleanedData = cleanedData[i - 1]) === null || _cleanedData === void 0 ? void 0 : _cleanedData.acv) || maxAcv;\n      const topWidth = prevAcv / maxAcv * funnelWidth;\n      const bottomWidth = d.acv / maxAcv * funnelWidth;\n      const x = (width - topWidth) / 2;\n      const nextX = (width - bottomWidth) / 2;\n      const y = i * sectionHeight;\n      const points = [[x, y], [x + topWidth, y], [nextX + bottomWidth, y + sectionHeight], [nextX, y + sectionHeight]];\n      svg.append(\"polygon\").attr(\"points\", points.map(p => p.join(\",\")).join(\" \")).attr(\"fill\", color(i)).attr(\"opacity\", 0).transition().duration(800).delay(i * 200).attr(\"opacity\", 1);\n\n      // Optional label\n      svg.append(\"text\").attr(\"x\", width / 2).attr(\"y\", y + sectionHeight / 2).attr(\"dy\", \".35em\").attr(\"text-anchor\", \"middle\").style(\"fill\", \"#fff\").style(\"font-size\", \"clamp(10px, 1.5vw, 24px)\").style(\"font-weight\", \"bold\").style(\"opacity\", 0).text(`${d.label}: $${d.acv.toLocaleString()}`).transition().duration(600).delay(i * 200 + 300).style(\"opacity\", 1);\n    });\n  }, [data]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    style: {\n      width: \"100%\",\n      height: \"100%\",\n      maxHeight: \"100vh\",\n      padding: \"1rem\"\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n_s(FunnelChart, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c = FunnelChart;\nexport default FunnelChart;\nvar _c;\n$RefreshReg$(_c, \"FunnelChart\");","map":{"version":3,"names":["d3","useEffect","useRef","jsxDEV","_jsxDEV","FunnelChart","data","_s","ref","current","cleanedData","map","d","acv","Number","width","clientWidth","console","error","height","svg","select","html","append","attr","style","maxAcv","max","funnelWidth","sectionHeight","length","color","scaleOrdinal","schemeBlues","forEach","i","_cleanedData","prevAcv","topWidth","bottomWidth","x","nextX","y","points","p","join","transition","duration","delay","text","label","toLocaleString","maxHeight","padding","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/HP/Desktop/Sayjan Desktop/Projects/DataFunnel/frontend/src/components/FunnelChart.js"],"sourcesContent":["import * as d3 from \"d3\";\r\nimport { useEffect, useRef } from \"react\";\r\n\r\nconst FunnelChart = ({ data }) => {\r\n  const ref = useRef();\r\n\r\n  useEffect(() => {\r\n    if (!data || !ref.current) return;\r\n\r\n    const cleanedData = data.map((d) => ({\r\n      ...d,\r\n      acv: Number(d.acv),\r\n    }));\r\n\r\n    const width = ref.current.clientWidth;\r\n    if (width === 0) {\r\n      console.error(\"Chart container width is zero.\");\r\n      return;\r\n    }\r\n\r\n    const height = 500;\r\n    const svg = d3\r\n      .select(ref.current)\r\n      .html(\"\")\r\n      .append(\"svg\")\r\n      .attr(\"viewBox\", `0 0 ${width} ${height}`)\r\n      .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\r\n      .style(\"width\", \"100%\")\r\n      .style(\"height\", \"100%\");\r\n\r\n    const maxAcv = d3.max(cleanedData, (d) => d.acv);\r\n    const funnelWidth = width * 0.9;\r\n    const sectionHeight = height / cleanedData.length;\r\n    const color = d3.scaleOrdinal(d3.schemeBlues[cleanedData.length + 1]);\r\n\r\n    cleanedData.forEach((d, i) => {\r\n      const prevAcv = cleanedData[i - 1]?.acv || maxAcv;\r\n\r\n      const topWidth = (prevAcv / maxAcv) * funnelWidth;\r\n      const bottomWidth = (d.acv / maxAcv) * funnelWidth;\r\n\r\n      const x = (width - topWidth) / 2;\r\n      const nextX = (width - bottomWidth) / 2;\r\n      const y = i * sectionHeight;\r\n\r\n      const points = [\r\n        [x, y],\r\n        [x + topWidth, y],\r\n        [nextX + bottomWidth, y + sectionHeight],\r\n        [nextX, y + sectionHeight],\r\n      ];\r\n\r\n      svg\r\n        .append(\"polygon\")\r\n        .attr(\"points\", points.map((p) => p.join(\",\")).join(\" \"))\r\n        .attr(\"fill\", color(i))\r\n        .attr(\"opacity\", 0)\r\n        .transition()\r\n        .duration(800)\r\n        .delay(i * 200)\r\n        .attr(\"opacity\", 1);\r\n\r\n      // Optional label\r\n      svg\r\n        .append(\"text\")\r\n        .attr(\"x\", width / 2)\r\n        .attr(\"y\", y + sectionHeight / 2)\r\n        .attr(\"dy\", \".35em\")\r\n        .attr(\"text-anchor\", \"middle\")\r\n        .style(\"fill\", \"#fff\")\r\n        .style(\"font-size\", \"clamp(10px, 1.5vw, 24px)\")\r\n        .style(\"font-weight\", \"bold\")\r\n        .style(\"opacity\", 0)\r\n        .text(`${d.label}: $${d.acv.toLocaleString()}`)\r\n        .transition()\r\n        .duration(600)\r\n        .delay(i * 200 + 300)\r\n        .style(\"opacity\", 1);\r\n    });\r\n  }, [data]);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      style={{\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        maxHeight: \"100vh\",\r\n        padding: \"1rem\",\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default FunnelChart;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}